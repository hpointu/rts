{"version":3,"sources":["hpointu/rts/input.cljs"],"mappings":";AAEA,AAAA,AAAAA,AAAAC,AAAAC,AAAAC;AAAA;AAAA,AAAA,AAASC,AAAO,AAAA,AAACC;;AACjB,AAAA,AAAAL,AAAAC,AAAAC,AAAAI;AAAA;AAAA,AAAA,AAASC,AAAM,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAACF;;AAEhB,AAAA,AAAMG,AAAcC;AAApB,AACE,AAAA,AAAAC,AAACC,AAAWP,AAAOK;;AAErB,AAAA,AAAMG,AAAgBH;AAAtB,AACE,AAAA,AAAAC,AAACG,AAAKN,AAAME;;AAEd,AAAA,AAAMK,AAAWC;AAAjB,AACE,AAAMK,AAAK,AAAwBL;AAAnCC,AAAA,AAAAN,AACqBH;AADrBS,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAA,AAAA,AAAA,AAAAA,AAAA,AAAA,AAAAC,AAAA,AAAAD,AAAA,AAAA,AAAA,AAAA,AAAAE,AAAAC,AAAAH,AAAAA;AAAA,AAAAH,AAAAG,AAAA,AACcK;AADd,AAAAR,AAAAG,AAAA,AACgBM;AADhB,AAAA,AAEG,AAAGD,AAAE,AAAQD,AACb,AAAGE,AAAE,AAAOF;;AAEjB,AAAA,AAAOG,AAASC;AAAhB,AACE,AAAM,AAAA,AAACC,AAAI,AAAAD;AAAX,AACE,AAAA,AAAA,AAACE,AAAMnB,AAAMoB;;AADf;;AAEA,AAAM,AAAA,AAACF,AAAI,AAAAD;AAAX,AACE,AAAA,AAAA,AAACE,AAAMnB,AAAMoB;;AADf;;;AAGF,AAAA,AAAOC,AAAWJ;AAAlB,AACE,AAAM,AAAA,AAACC,AAAI,AAAAD;AAAX,AACE,AAAA,AAAA,AAACE,AAAMnB,AAAMoB;;AADf;;AAEA,AAAM,AAAA,AAACF,AAAI,AAAAD;AAAX,AACE,AAAA,AAAA,AAACE,AAAMnB,AAAMoB;;AADf;;;AAGF,AAAA,AAAME;AAAN,AACE,AAAA,AAAA,AAAAC,AAACC;AAAD,AAAyC,AAACL,AAAMtB,AAAO4B,AAAK,AAAAF;;;AAC5D,AAAA,AAAA,AAAAG,AAACF;AAAD,AAAuC,AAACL,AAAMtB,AAAO8B,AAAK,AAAAD;;;AAC1D,AAAA,AAACF,AAAuCR;;AACxC,AAAA,AAACQ,AAAyCH;;AAC1C,AAAA,AAAA,AAAAO,AAACJ;AAAD,AAA2C,AAAA,AAAA,AAACL,AAAMnB,AAAMoB,AACH,AAAAQ,AACA,AAAAA","names":["js/hpointu","js/hpointu.rts","js/hpointu.rts.input","js/hpointu.rts.input.keymap","hpointu.rts.input/keymap","cljs.core.atom","js/hpointu.rts.input.mouse","hpointu.rts.input/mouse","hpointu.rts.input/key-pressed?","code","cljs.core/deref","cljs.core/contains?","hpointu.rts.input/mouse-pressed?","cljs.core.get","hpointu.rts.input/mouse-pos","elem","map__111752","cljs.core/PROTOCOL_SENTINEL","cljs.core.apply","cljs.core/hash-map","rect","x","y","hpointu.rts.input/mouseup","e","cljs.core._EQ_","cljs.core.swap_BANG_","cljs.core/assoc","hpointu.rts.input/mousedown","hpointu.rts.input/init!","p1__111754#","js/document.addEventListener","cljs.core/conj","p1__111755#","cljs.core/disj","p1__111756#"],"sourcesContent":["(ns hpointu.rts.input)\n\n(defonce keymap (atom #{}))\n(defonce mouse (atom {:x 0 :y 0 :left false :right false}))\n\n(defn key-pressed? [code]\n  (contains? @keymap code))\n\n(defn mouse-pressed? [code]\n  (get @mouse code))\n\n(defn mouse-pos [elem]\n  (let [rect (.getBoundingClientRect elem)\n        {:keys [x y]} @mouse]\n    [(- x (.-left rect))\n     (- y (.-top rect))]))\n\n(defn- mouseup [e]\n  (when (= 0 e.button)\n    (swap! mouse assoc :left false))\n  (when (= 2 e.button)\n    (swap! mouse assoc :right false)))\n\n(defn- mousedown [e]\n  (when (= 0 e.button)\n    (swap! mouse assoc :left true))\n  (when (= 2 e.button)\n    (swap! mouse assoc :right true)))\n\n(defn init! []\n  (js/document.addEventListener \"keydown\" #(swap! keymap conj (.-code %)))\n  (js/document.addEventListener \"keyup\" #(swap! keymap disj (.-code %)))\n  (js/document.addEventListener \"mouseup\" mouseup)\n  (js/document.addEventListener \"mousedown\" mousedown)\n  (js/document.addEventListener \"mousemove\" #(swap! mouse assoc\n                                                    :x (.-clientX %)\n                                                    :y (.-clientY %))))\n"]}